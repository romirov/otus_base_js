(()=>{"use strict";async function e(e){const t=`https://api.openweathermap.org/data/2.5/weather?units=metric&q=${e}&appid=7881bfb7be02c74633e5fdee4ff41329`;try{const e=await fetch(t);return await e.json()}catch(t){return console.error(`Could not find current location information by ${e}, because:`,t),null}}function t(e){for(;e.firstChild;)e.removeChild(e.firstChild)}async function n(e){const n=e.name,o=e.main.temp,c=e.weather[0].icon,a=document.getElementById("selectedCityMap");a.childNodes.length>=1&&t(a);const r=document.getElementById("selectedCityWeather");r.childNodes.length>=3&&t(r);const i=document.createElement("img");var l,s;i.src=await(l=e.coord.lat,s=e.coord.lon,`https://static-maps.yandex.ru/v1?ll=${s},${l}&lang=ru_RU&size=250,250&z=9&apikey=b7c1948d-26fc-46fa-bae3-f5d8ae0f2862`);const d=document.createElement("p");d.textContent=`City: ${n}`;const u=document.createElement("p");u.textContent=`Temperature: ${Math.round(o)} ℃`;const m=document.createElement("img");m.src=`http://openweathermap.org/img/wn/${c}.png`,a.append(i),r.append(d),r.append(u),r.append(m)}const o=10;function c(){const t=document.getElementById("memorizedCities"),o=Object.keys(localStorage);console.log(o),o.length>0&&o.forEach((o=>{const c=document.createElement("li"),a=document.createElement("a");a.href="",a.setAttribute("id","link"),a.innerText=o,a.addEventListener("click",(async t=>{t.preventDefault(),console.log(`Нажали на ссылку с сохраненным городом ${o}`),n(await e(o))})),c.appendChild(a),t.appendChild(c)}))}const a=document.getElementById("applicationForm");function r(t){t.preventDefault(),async function(t){const{elements:a}=t,r=a.userInput.value;console.log(`Ввели город ${r}`),function(e){const t=localStorage.length;if(null==localStorage.getItem(e))if(t<o)localStorage.setItem(e,e);else{const t=localStorage.key(0);localStorage.removeItem(t),localStorage.setItem(e,e)}}(r),n(await e(r)),c()}(a)}!async function(){n(await async function(){const t=await async function(){try{return(await fetch("https://get.geojs.io/v1/ip/geo.json",{mode:"cors"})).json()}catch(e){return console.error("Could`t find current location information by ip, because:",e),null}}();return await e(t.city)}()),a.addEventListener("submit",r),c()}()})();