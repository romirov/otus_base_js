(()=>{"use strict";async function t(t){const e=`https://api.openweathermap.org/data/2.5/weather?units=metric&q=${t}&appid=7881bfb7be02c74633e5fdee4ff41329`;try{const t=await fetch(e);return await t.json()}catch(e){return console.error(`Could not find current location information by ${t}, because:`,e),null}}function e(t){for(;t.firstChild;)t.removeChild(t.firstChild)}async function n(t){const n=t.name,o=t.main.temp,a=t.weather[0].icon,c=document.getElementById("selectedCityMap");c.childNodes.length>=1&&e(c);const i=document.getElementById("selectedCityWeather");i.childNodes.length>=3&&e(i);const r=document.createElement("img");var l,s;r.setAttribute("id","map"),r.src=await(l=t.coord.lat,s=t.coord.lon,`https://static-maps.yandex.ru/v1?ll=${s},${l}&lang=ru_RU&size=250,250&z=9&apikey=b7c1948d-26fc-46fa-bae3-f5d8ae0f2862`);const d=document.createElement("p");d.setAttribute("id","cityName"),d.textContent=`City: ${n}`;const u=document.createElement("p");u.setAttribute("id","cityWeather"),u.textContent=`Temperature: ${Math.round(o)} ℃`;const m=document.createElement("img");m.setAttribute("id","cityWeatherImg"),m.src=`http://openweathermap.org/img/wn/${a}.png`,c.append(r),i.append(d),i.append(u),i.append(m)}const o=10;function a(){const e=document.getElementById("memorizedCities"),o=Object.keys(localStorage);o.length>0&&o.forEach((o=>{const a=document.createElement("li"),c=document.createElement("a");c.href="",c.setAttribute("id","link"),c.innerText=o,c.addEventListener("click",(async e=>{e.preventDefault(),console.log(`Нажали на ссылку с сохраненным городом ${o}`),n(await t(o))})),a.appendChild(c),e.appendChild(a)}))}const c=document.getElementById("applicationForm");function i(e){e.preventDefault(),async function(e){const{elements:c}=e,i=c.userInput.value;console.log(`Ввели город ${i}`),function(t){const e=localStorage.length;if(null==localStorage.getItem(t))if(e<o)localStorage.setItem(t,t);else{const e=localStorage.key(0);localStorage.removeItem(e),localStorage.setItem(t,t)}}(i),n(await t(i)),a()}(c)}!async function(){n(await async function(){const e=await async function(){try{return(await fetch("https://get.geojs.io/v1/ip/geo.json",{mode:"cors"})).json()}catch(t){return console.error("Could`t find current location information by ip, because:",t),null}}();return await t(e.city)}()),c.addEventListener("submit",i),a()}()})();